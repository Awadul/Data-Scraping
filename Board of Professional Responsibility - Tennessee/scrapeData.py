import requests
from bs4 import BeautifulSoup
import json
import time
import random
from concurrent.futures import ThreadPoolExecutor, as_completed
from functools import partial
import sys
from collections import defaultdict

# Configuration
MAX_RETRIES = 3
MAX_WORKERS = 2  # Reduced to 2 workers
MIN_DELAY = 1    # seconds
MAX_DELAY = 5    # seconds
ERROR_DELAY_MIN = 5  # seconds (minimum delay after error)
ERROR_DELAY_MAX = 7  # seconds (maximum delay after error)
TIMEOUT = 30     # seconds per request

def scrape_attorney_data(bpr_number, attempt=1):
    url = f"https://www.tbpr.org/attorneys/{bpr_number:06d}"
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
    }
    
    try:
        # Random delay before each attempt
        if attempt > 1:
            retry_delay = random.uniform(ERROR_DELAY_MIN, ERROR_DELAY_MAX)
            time.sleep(retry_delay)
            
        response = requests.get(url, headers=headers, timeout=TIMEOUT)
        response.raise_for_status()
        
        soup = BeautifulSoup(response.text, 'html.parser')
        
        # Extract basic information
        attorney_data = {
            "BPR_Number": f"{bpr_number:06d}",
            "URL": url
        }
        
        # Extract details from the dl element
        dl = soup.find('section', class_='content').find('dl')
        if dl:
            dt_elements = dl.find_all('dt')
            dd_elements = dl.find_all('dd')
            
            for dt, dd in zip(dt_elements, dd_elements):
                key = dt.get_text(strip=True).replace(':', '')
                value = dd.get_text(strip=True)
                
                # Handle the special case for Status which has a modal
                if key == 'Status':
                    modal_div = dd.find('div', class_='js-btn')
                    if modal_div:
                        value = modal_div.get_text(strip=True)
                
                attorney_data[key] = value
        
        # Extract public information
        sections = soup.find_all('section', class_='content')
        if len(sections) > 1:
            public_info_section = sections[1]
            h3 = public_info_section.find('h3')
            if h3 and 'Public Information' in h3.get_text(strip=True):
                strong = public_info_section.find('strong')
                if strong:
                    attorney_data['Public_Information'] = strong.get_text(strip=True)
        
        # Extract disciplinary information
        if len(sections) > 2:
            discipline_section = sections[2]
            h3 = discipline_section.find('h3')
            if h3 and 'Public Discipline' in h3.get_text(strip=True):
                strong = discipline_section.find('strong')
                if strong:
                    attorney_data['Public_Discipline'] = strong.get_text(strip=True)
        
        # Extract names used
        if len(sections) > 3:
            names_section = sections[3]
            h3 = names_section.find('h3')
            if h3 and 'Names Used' in h3.get_text(strip=True):
                table = names_section.find('table')
                if table:
                    names = [td.get_text(strip=True) for td in table.find_all('td')]
                    attorney_data['Names_Used'] = names
        
        # Extract last updated information
        last_updated = soup.find('section', class_='content').find_next('p')
        if last_updated:
            attorney_data['Last_Updated'] = last_updated.get_text(strip=True)
        
        return attorney_data
    
    except requests.exceptions.RequestException as e:
        if attempt < MAX_RETRIES:
            return scrape_attorney_data(bpr_number, attempt + 1)
        else:
            print(f"Failed to fetch data for BPR {bpr_number:06d} after {MAX_RETRIES} attempts: {e}", file=sys.stderr)
            return {
                "BPR_Number": f"{bpr_number:06d}",
                "URL": url,
                "Error": str(e),
                "Attempts": attempt
            }

def process_bpr_number(bpr_number, progress_counter=None):
    # Random delay to avoid overwhelming the server
    delay = random.uniform(MIN_DELAY, MAX_DELAY)
    time.sleep(delay)
    
    result = scrape_attorney_data(bpr_number)
    
    if progress_counter:
        with progress_counter.get_lock():
            progress_counter.value += 1
            print(f"\rProgress: {progress_counter.value}/{progress_counter.total} ", end='', flush=True)
    
    return result

def main():
    # Example array of BPR numbers
    bpr_numbers = [1801,
1870,
2048,
1212,
1164,
1011,
1076,
1077,
536,
416,
832,
896,
28689,
28124,
28058,
27944,
41150,
40568,
40840,
39165,
40156,
40116,
40340,
40404,
39458,
41682,
38638,
38691,
40185,
36088,
36404,
36510,
39155,
37138,
37147,
37509,
37301,
37258,
37312,
37347,
37734,
38182,
38550,
38364,
38279,
38076,
5450,
5438,
5278,
5773,
6302,
6088,
5965,
4309,
4170,
4201,
4099,
4149,
4837,
5211,
5235,
5245,
5076,
5077,
5011,
5016,
4991,
35058,
34880,
35389,
35057,
35952,
35919,
34164,
34165,
34166,
6573,
6563,
6549,
6728,
6608,
34660,
34371,
41219,
39828,
41141,
39924,
42619,
40091,
40441,
40980,
38755,
42502,
35883,
225,
9138,
13089,
39442,
10921,
30687,
29980,
18342,
5949,
18343,
10260,
28517,
16005,
19317,
16007,
23139,
2913,
42268,
16008,
16611,
12891,
17905,
17906,
9750,
8550,
8646,
36740,
40784,
39291,
11898,
20831,
23533,
36741,
31933,
22699,
18567,
20673,
7480,
27991,
37510,
19715,
19056,
42430,
42599,
21404,
33140,
20139,
17275,
33056,
37109,
36742,
22700,
31046,
40233,
37834,
5313,
4427,
34167,
22701,
27768,
27090,
2032,
2396,
29073,
31354,
8707,
12387,
12581,
12582,
12785,
13273,
16612,
15422,
15401,
15101,
22035,
19057,
10922,
10923,
10392,
29074,
6865,
31501,
3114,
3220,
28465,
505,
641,
26666,
27800,
27674,
34148,
33962,
33830,
4310,
5135,
4922,
5361,
5385,
5835,
6286,
37877,
36149,
40078,
39089,
38848,
24937,
29075,
7105,
31049,
2296,
2297,
34168,
35592,
6999,
39292,
38592,
34641,
19058,
17644,
40106,
40014,
29076,
6780,
28911,
8419,
10393,
10167,
12004,
17620,
17697,
18568,
21792,
21575,
42088,
42269,
36512,
35059,
6031,
5678,
2507,
3790,
3478,
1162,
22702,
22646,
23534,
25835,
40925,
33228,
14913,
24088,
17221,
8737,
7593,
41598,
25295,
26217,
673,
325,
3617,
3131,
34642,
33465,
30645,
17276,
15382,
14764,
14028,
25154,
11906,
30748,
19318,
1269,
37069,
22398,
9865,
29176,
28329,
32013,
36304,
38417,
38507,
1496,
26795,
3242,
3791,
2676,
37957,
32458,
7034,
8468,
39293,
2616,
10394,
18483,
35953,
36483,
31784,
10395,
32734,
36743,
2939,
41220,
22378,
11956,
2891,
3589,
23842,
32014,
31639,
18344,
26077,
18345,
8281,
7886,
40643,
35060,
39060,
10202,
36620,
1007,
21280,
20664,
32464,
36744,
23535,
34169,
37447,
40234,
29641,
34101,
41011,
14251,
12500,
21530,
38800,
34707,
19319,
40466,
15140,
21405,
14252,
17278,
32727,
29275,
33229,
8332,
5382,
4870,
23230,
328,
41221,
22703,
35909,
40120,
35407,
12005,
18431,
9374,
1416,
35806,
2797,
10396,
6781,
9140,
14592,
12874,
42236,
7066,
30985,
35954,
33992,
38361,
38129,
32015,
14593,
19649,
35062,
35061,
16994,
28775,
6416,
19749,
15323,
15953,
14765,
32016,
40490,
42648,
14766,
27020,
9751,
5815,
39273,
23231,
17198,
24340,
1976,
20780,
19320,
7900,
8427,
29623,
2583,
2650,
4268,
31715,
7485,
19215,
37026,
22704,
34940,
34708,
35955,
41075,
15392,
14767,
13730,
26218,
14768,
95,
5840,
14569,
29077,
31051,
1229,
1942,
3731,
3303,
26796,
5699,
39956,
40757,
40410,
42441,
37909,
38253,
32647,
31581,
7255,
12583,
18569,
18570,
21406,
33641,
34199,
23232,
20332,
13731,
31539,
9375,
27125,
26219,
1376,
26220,
25296,
23873,
24089,
24012,
34170,
6398,
6378,
4091,
38168,
39223,
12584,
16010,
39436,
37511,
2914,
3785,
4771,
35956,
20674,
10397,
29078,
33642,
1557,
4838,
4619,
19991,
13732,
20404,
104,
956,
731,
22705,
5607,
15402,
16615,
11805,
11806,
5248,
40949,
10400,
13733,
10924,
25297,
38997,
14723,
7000,
42089,
28427,
14769,
14770,
17279,
17233,
16011,
19992,
22379,
17907,
9376,
851,
3393,
27686,
39912,
37250,
6463,
35063,
4803,
37110,
26221,
24341,
24342,
11428,
18571,
21853,
29079,
36745,
7819,
16012,
41174,
15304,
31052,
37704,
37621,
42028,
41761,
4387,
35466,
34089,
24343,
24028,
24208,
24938,
23233,
23537,
3618,
2748,
1932,
1272,
226,
29759,
8343,
12006,
10749,
15383,
15687,
12585,
14253,
19993,
17908,
17880,
13734,
28544,
18348,
18149,
12323,
8797,
19321,
21408,
34171,
9912,
29761,
14254,
35526,
4256,
36316,
39630,
1638,
25896,
26702,
14255,
19994,
19368,
20684,
14256,
17280,
16013,
8801,
24344,
1465,
6089,
22644,
31640,
30944,
35511,
40747,
4361,
32017,
7775,
13179,
4587,
6659,
37335,
16403,
7256,
39469,
37273,
40235,
25140,
24593,
26703,
27126,
27127,
25298,
2773,
3237,
3990,
8116,
12007,
33371,
29667,
30960,
15393,
14198,
14085,
20665,
41222,
9913,
42629,
8294,
8471,
19297,
35957,
35064,
24090,
14594,
10398,
38236,
40082,
23195,
37512,
29763,
18572,
13735,
16428,
30055,
30675,
10399,
9752,
8900,
9141,
38377,
36513,
40572,
35377,
35734,
34084,
6052,
6372,
23883,
25299,
26222,
41014,
31817,
22028,
2862,
23538,
37814,
31834,
30091,
15328,
37678,
27767,
27751,
26117,
25993,
23540,
23234,
22706,
24053,
2838,
2867,
1892,
2091,
2117,
2340,
1426,
674,
9,
157,
28254,
27942,
37513,
37355,
37711,
36264,
37045,
40566,
41798,
41500,
38737,
5329,
5569,
5600,
5175,
5002,
33939,
6615,
15403,
15384,
16014,
14771,
14772,
19322,
19059,
33230,
32018,
30561,
8176,
8047,
7921,
11430,
41702,
42575,
37314,
35958,
10,
9753,
41975,
15789,
16983,
9142,
35959,
4301,
7210,
15164,
13565,
37467,
800,
798,
23235,
19995,
39670,
38295,
13665,
32604,
39294,
6901,
3531,
16617,
32662,
13530,
21409,
33621,
3258,
2060,
38551,
37085,
38796,
38405,
34173,
40134,
36747,
35065,
27905,
27969,
27992,
1049,
3792,
23541,
24091,
25162,
27128,
35066,
6616,
4626,
36748,
36613,
36434,
38248,
33231,
30092,
31053,
30014,
31355,
29081,
32119,
7322,
8546,
9914,
9915,
11558,
10925,
10926,
22453,
19996,
18573,
18528,
17715,
13737,
14773,
12938,
16618,
15394,
40819,
3363,
1255,
23542,
15404,
17281,
18574,
11431,
7877,
29975,
31560,
29558,
37514,
33027,
20360,
20550,
28803,
37942,
20441,
20234,
33742,
29082,
6262,
35697,
30957,
36644,
28536,
25300,
9378,
24367,
37037,
326,
26118,
1171,
174,
14876,
42357,
1259,
1565,
12586,
13738,
19189,
32019,
42470,
17909,
35067,
5187,
24860,
22036,
19997,
17910,
17716,
12587,
17282,
31671,
33232,
6931,
9379,
9380,
24345,
23543,
25301,
1342,
4388,
6510,
33831,
34007,
38534,
36749,
37992,
25302,
39295,
22707,
20595,
7329,
18349,
12485,
38939,
39631,
15738,
14775,
14776,
15314,
15165,
22037,
21410,
7413,
7496,
9916,
29977,
29668,
29084,
32021,
32689,
32020,
37768,
35068,
4753,
4778,
24346,
25132,
25897,
27129,
27130,
1509,
1514,
158,
1924,
3281,
41727,
26042,
25303,
6317,
5244,
27131,
706,
8148,
21411,
17717,
16620,
11432,
16015,
11807,
30093,
29085,
10927,
35069,
40909,
26224,
11361,
29086,
20133,
18575,
19522,
16016,
16196,
13531,
32022,
415,
17283,
26225,
40011,
34661,
2339,
35960,
33699,
31797,
2798,
24688,
3546,
28440,
38938,
29087,
8260,
9143,
17091,
39672,
38145,
21565,
4494,
24858,
24259,
23544,
21326,
15090,
31905,
31055,
12939,
40021,
39869,
38987,
33105,
23545,
19363,
39877,
17659,
6917,
30933,
22038,
14257,
15109,
24347,
24939,
26226,
26227,
25304,
26797,
3334,
3335,
3336,
2465,
5105,
41224,
36284,
39654,
16213,
15395,
13739,
30689,
30596,
7036,
11808,
9917,
35070,
2292,
3325,
3029,
3030,
27850,
41225,
20052,
20654,
22454,
22455,
17467,
18577,
19672,
19926,
19061,
13767,
14022,
14258,
14595,
12940,
12941,
12942,
12943,
13146,
13181,
13182,
12588,
12589,
15287,
16017,
16018,
15386,
16622,
17284,
17285,
9918,
9919,
9738,
10177,
10401,
10402,
10703,
12008,
11238,
10750,
7211,
7284,
8191,
40026,
30096,
31716,
33106,
30600,
31056,
28873,
28701,
6961,
29739,
29440,
31553,
30095,
31790,
30275,
32981,
33233,
27665,
26798,
27132,
27133,
25305,
26228,
26092,
25898,
23547,
22710,
22711,
22712,
3323,
3514,
3991,
2606,
28382,
28059,
27964,
27950,
16621,
296,
425,
1508,
1424,
1260,
1249,
1250,
35071,
35072,
35515,
34175,
34518,
34054,
6617,
5212,
4220,
6346,
5634,
37515,
36615,
36405,
36375,
37236,
38567,
40479,
42351,
21166,
3195,
23546,
35889,
42283,
40974,
282,
14596,
12590,
17045,
16619,
8431,
8177,
8071,
9754,
9920,
23548,
24635,
4273,
16623,
3891,
14572,
9382,
26229,
31057,
9103,
39772,
8576,
8514,
7879,
9755,
12009,
12010,
12011,
12012,
11957,
11433,
14597,
14778,
14259,
14260,
14041,
13183,
20115,
22713,
4563,
4431,
35073,
6660,
34083,
25306,
5542,
6032,
24940,
35961,
34709,
10801,
5670,
939,
29088,
33234,
28737,
31356,
10928,
9921,
7035,
14779,
14780,
14640,
28273,
3532,
3160,
3230,
22714,
6090,
5226,
6661,
36751,
37483,
39296,
28255,
978,
24553,
16019,
31058,
4026,
9006,
14017,
12944,
41780,
40873,
12945,
28887,
16405,
39199,
39640,
38903,
11239,
39669,
14261,
19999,
20880,
10403,
34018,
977,
42478,
42598,
33235,
20000,
982,
35000,
33803,
18578,
17287,
40743,
36667,
32024,
15396,
17113,
8811,
3116,
3793,
2448,
1719,
36752,
37216,
4527,
6983,
30750,
37153,
11240,
39483,
8361,
32619,
30465,
29089,
21412,
19751,
16020,
38970,
26231,
41817,
40805,
35687,
15406,
14262,
13996,
22456,
7842,
12013,
40633,
30859,
18350,
12209,
36753,
34710,
17911,
11,
40642,
41964,
20001,
19227,
22039,
35108,
21134,
40407,
40371,
38266,
37516,
6729,
4997,
4754,
25603,
26961,
23549,
14325,
31570,
30049,
39932,
39297,
32025,
29768,
13740,
17288,
2759,
6091,
28834,
12591,
17718,
24349,
22424,
24274,
2868,
465,
17289,
39000,
18579,
7795,
39593,
13532,
9320,
9383,
2541,
41089,
3748,
4436,
9384,
9856,
7598,
29984,
29090,
14086,
12339,
20002,
20003,
40123,
5334,
33808,
39270,
39843,
40996,
37978,
35074,
35674,
35534,
5332,
5377,
6137,
5922,
2754,
1819,
1690,
828,
23814,
27745,
25899,
18134,
19324,
19309,
12389,
14263,
17291,
16429,
16431,
15751,
29091,
33734,
33593,
9144,
8966,
9923,
11849,
11809,
33063,
31132,
29092,
29093,
29011,
15762,
16021,
14048,
17667,
26232,
25308,
27134,
27135,
22715,
592,
28690,
2677,
3364,
5628,
4779,
34888,
35075,
39232,
41544,
38576,
29094,
28984,
12592,
11434,
35015,
29095,
12946,
21346,
22040,
34711,
42442,
38659,
3892,
502,
38882,
26611,
14988,
843,
1777,
1778,
22716,
23062,
39914,
41607,
34176,
40175,
39930,
34554,
35076,
35472,
38885,
41757,
42335,
38258,
37517,
37247,
36485,
22717,
26078,
3382,
16022,
15651,
12883,
21414,
29032,
30097,
31466,
33141,
30124,
33707,
9145,
7863,
39878,
39298,
29096,
21415,
21416,
21971,
12593,
13741,
14782,
1985,
850,
25147,
37111,
41084,
6730,
19325,
19326,
17719,
17912,
17913,
17914,
18312,
18582,
18583,
18584,
21417,
21327,
20004,
20005,
20442,
20676,
20666,
20686,
14264,
13742,
14037,
13990,
14087,
12598,
12546,
12390,
12947,
12948,
13185,
15790,
15166,
16624,
16561,
17292,
29097,
29991,
29769,
28708,
28851,
32027,
30098,
32735,
32026,
31059,
7529,
7037,
7285,
11435,
11769,
10751,
10322,
33832,
34514,
4948,
5411,
6353,
38999,
40236,
41061,
37225,
37518,
24966,
24093,
23386,
26234,
25309,
25310,
25836,
503,
480,
528,
1046,
155,
27903,
28122,
2171,
3373,
3749,
3333,
41685,
40516,
41226,
41430,
22628,
40024,
5147,
34177,
11241,
11242,
20667,
39812,
26704,
573,
25155,
27137,
41811,
42342,
38407,
36754,
34712,
4061,
24094,
22718,
11436,
9924,
9925,
7557,
22614,
23936,
2001,
31641,
27773,
37765,
38221,
34689,
40031,
40499,
23550,
3559,
12,
16076,
16023,
14265,
40995,
24351,
24352,
27454,
42090,
39097,
35541,
34821,
34901,
5467,
31060,
29495,
9385,
9386,
10404,
12014,
21376,
22185,
17915,
4966,
35077,
35467,
22719,
22860,
28409,
1568,
1579,
16625,
41227,
10697,
9387,
22457,
19090,
24622,
38728,
16378,
17885,
22720,
1013,
35820,
30099,
25311,
20443,
40910,
30751,
7707,
36311,
36079,
15791,
13186,
19752,
38217,
33833,
17916,
27010,
22721,
22757,
25562,
35078,
13959,
12015,
37065,
38602,
13535,
24849,
18351,
22458,
29099,
36693,
37519,
40894,
35803,
25312,
6863,
9926,
9757,
24353,
23551,
153,
3161,
9758,
30100,
2678,
5557,
31514,
39857,
31061,
31642,
28203,
40237,
31608,
33695,
18585,
12886,
6486,
4118,
24885,
25192,
13097,
14783,
14781,
8414,
39069,
33097,
32028,
12594,
12595,
21854,
38024,
5018,
822,
1679,
1753,
2774,
2775,
19327,
20006,
16626,
31062,
7818,
1632,
2266,
39279,
27138,
38408,
14784,
20017,
32657,
41539,
40344,
26799,
3992,
21168,
34713,
42628,
35890,
3794,
7106,
40675,
26988,
23552,
23236,
13510,
15111,
28618,
38805,
6323,
15857,
20677,
25313,
16432,
14266,
2864,
8247,
32722,
17917,
997,
26235,
26236,
27139,
26913,
5512,
38409,
17918,
9388,
9389,
39946,
29535,
28988,
21697,
13729,
25314,
23146,
36273,
36210,
15761,
41619,
12016,
22042,
1851,
7827,
22843,
20668,
26800,
40238,
4632,
39950,
34517,
194,
24256,
30877,
41139,
12017,
9390,
22413,
23237,
30680,
11243,
25900,
20678,
18496,
25315,
24941,
35830,
17332,
18586,
20182,
34714,
6526,
36818,
22723,
87,
33237,
29599,
29600,
7938,
14267,
14785,
14786,
22724,
27140,
27675,
6618,
5157,
27141,
33238,
7675,
35079,
19328,
28384,
3199,
25378,
35962,
34715,
40070,
20669,
7074,
31063,
14598,
12596,
16627,
29167,
28788,
31357,
30101,
8461,
42312,
37490,
33870,
35963,
35964,
5586,
25316,
25827,
2776,
2817,
28125,
10752,
5872,
38656,
5071,
1151,
2123,
5216,
7038,
16027,
9391,
30752,
41507,
36755,
34178,
26326,
9927,
22459,
20007,
31064,
24354,
25169,
17294,
17295,
12342,
13743,
13781,
13187,
16433,
20008,
32030,
33019,
8820,
27143,
27144,
2209,
1369,
5215,
6219,
38975,
26237,
40869,
31643,
30220,
39692,
5088,
24237,
20679,
40239,
23555,
30605,
29574,
10172,
10206,
11244,
11909,
20444,
20400,
22460,
15387,
15397,
14571,
26238,
25901,
26801,
28428,
105,
152,
40034,
5970,
35913,
41372,
41600,
13685,
16028,
28938,
22043,
22168,
24861,
35717,
25566,
1480,
9007,
25902,
40240,
7791,
41116,
41112,
3863,
24096,
8443,
20578,
21939,
21420,
16029,
13744,
12018,
655,
37998,
5205,
39299,
16614,
37095,
22372,
11810,
2679,
26802,
18588,
35851,
11200,
35080,
33240,
19098,
25317,
109,
2314,
27084,
24355,
6053,
41481,
12950,
6255,
23556,
3993,
3229,
14600,
14601,
14787,
12597,
16030,
15407,
3619,
13,
28210,
1340,
37520,
37440,
30102,
41183,
32032,
29102,
14268,
40829,
39707,
36756,
35498,
23415,
27147,
37894,
30253,
36707,
33931,
13188,
18323,
2390,
41364,
7212,
7039,
32971,
19062,
21992,
22044,
22079,
21421,
21130,
88,
89,
213,
27690,
23480,
22726,
4995,
4651,
4588,
38657,
41228,
7110,
25869,
3200,
2915,
21169,
31433,
2163,
27993,
38511,
31066,
11245,
27148,
35240,
715,
35826,
35594,
40083,
24942,
4072,
8610,
20010,
22315,
19329,
15002,
21422,
7213,
734,
736,
2043,
2187,
4404,
8600,
8585,
9928,
31067,
29982,
40901,
29770,
28793,
31068,
9929,
12020,
7040,
19330,
17046,
35536,
38643,
37521,
23238,
26239,
25224,
26803,
37179,
4944,
22461,
10447,
19331,
14788,
40538,
25809,
24042,
676,
154,
21110,
6938,
39733,
34869,
30011,
22462,
33115,
6355,
6054,
7041,
37996,
34717,
40179,
40876,
8871,
20012,
17047,
14789,
20013,
24350,
5064,
37237,
38757,
28296,
3893,
3894,
16628,
9034,
27902,
25903,
27851,
27825,
39795,
34718,
34980,
40706,
12599,
20670,
20680,
22727,
37680,
38990,
38673,
24943,
27852,
25904,
26240,
28673,
29103,
29523,
24356,
31069,
25318,
40957,
19937,
27149,
31070,
38715,
17048,
14014,
41229,
23557,
5477,
9393,
481,
846,
323,
23558,
24357,
24877,
4125,
35477,
35798,
39227,
42390,
20671,
20690,
21814,
4682,
4580,
35965,
38839,
24358,
26804,
488,
3201,
21423,
16693,
15167,
30103,
848,
38563,
41482,
27994,
17920,
38503,
26241,
23239,
24944,
17049,
11202,
22728,
23403,
37462,
34845,
25319,
10753,
21424,
34080,
30104,
27150,
14602,
12021,
8667,
29573,
24945,
24359,
27844,
40351,
33241,
30921,
3795,
36420,
4221,
28060,
25253,
24946,
23559,
10861,
12391,
8624,
5520,
22729,
9930,
29772,
42552,
29516,
40376,
42443,
29104,
13039,
39462,
22463,
17721,
25905,
17971,
19063,
14603,
26242,
18484,
42284,
36759,
17922,
31923,
10405,
16434,
315,
36760,
37028,
35966,
849,
3941,
29774,
33242,
8287,
19064,
32664,
31071,
13189,
5895,
34180,
37101,
17722,
34659,
34534,
34181,
34182,
34112,
6662,
35967,
35016,
6238,
4311,
4062,
4484,
5237,
37078,
36761,
38178,
39158,
38513,
3750,
3686,
2892,
1193,
991,
28248,
27696,
27362,
27152,
26806,
22730,
23240,
23560,
24360,
17723,
17653,
18338,
18352,
18589,
18590,
18218,
21328,
20681,
20014,
13190,
13255,
12951,
12952,
14560,
14270,
13745,
13746,
13747,
16435,
16437,
16629,
17050,
17297,
16734,
17015,
15408,
15047,
15792,
31644,
31073,
31074,
33245,
33246,
33243,
32570,
32611,
33694,
33244,
29776,
29105,
29620,
8898,
8787,
8901,
7541,
7869,
10601,
10588,
9931,
9932,
9759,
9760,
9860,
11246,
12022,
12023,
12024,
40601,
39300,
39301,
40783,
14269,
15409,
17196,
21974,
11536,
27153,
2029,
4197,
35690,
41230,
39088,
18353,
24361,
10179,
41231,
1006,
4808,
21804,
2039,
5769,
34585,
41490,
18592,
16999,
7616,
7600,
23561,
27154,
6731,
14271,
29605,
12454,
12600,
12392,
17298,
17051,
18593,
30105,
31075,
10406,
12025,
10929,
10930,
41819,
38410,
36763,
23395,
1720,
3796,
19333,
21425,
3031,
1028,
6371,
39302,
37144,
21965,
8617,
9394,
23562,
25323,
14272,
15793,
21835,
13993,
22464,
12026,
3994,
3399,
4495,
6619,
5733,
38208,
37522,
1574,
1244,
926,
27155,
33072,
6960,
20672,
13191,
16031,
15405,
14792,
14793,
30928,
12027,
41017,
14694,
20388,
18354,
25907,
36764,
38411,
27156,
24362,
17923,
20015,
21855,
9395,
7893,
40952,
37941,
23242,
27922,
5829,
20682,
14273,
17299,
16551,
24363,
26244,
12953,
30106,
19334,
39555,
29778,
28691,
1544,
2996,
8485,
20445,
14794,
17924,
7592,
33057,
28839,
22773,
5352,
4898,
33993,
39056,
35082,
35083,
36765,
24475,
31065,
32033,
31076,
11247,
17925,
23563,
23419,
24043,
26245,
38695,
18161,
20016,
7918,
39303,
7001,
3830,
30903,
7759,
19335,
2821,
23564,
39727,
34184,
20593,
36710,
39536,
35968,
19210,
17926,
3645,
16631,
11439,
7414,
41385,
30974,
30706,
20692,
14543,
33745,
38324,
25839,
16032,
13748,
19753,
24364,
41446,
42257,
39304,
39237,
40587,
35084,
35037,
5369,
5722,
5576,
5987,
3664,
3604,
2335,
28197,
21427,
13749,
13471,
14795,
33248,
7744,
7700,
8046,
11248,
18594,
35970,
36514,
9396,
31077,
26059,
22731,
33121,
32737,
19241,
21428,
21115,
20446,
14090,
32034,
33153,
8746,
8157,
7286,
25851,
27158,
28651,
2680,
2614,
6593,
5072,
7558,
38412,
2179,
2115,
40373,
7453,
6994,
7988,
12601,
15324,
9727,
14604,
5043,
1382,
25828,
17300,
10755,
7809,
30523,
35085,
22732,
24947,
12388,
12151,
22045,
42258,
14574,
16975,
16613,
16033,
13750,
21260,
24948,
625,
2466,
3950,
21170,
20703,
2157,
22733,
22734,
27160,
5798,
21171,
21429,
33101,
10700,
40821,
32035,
20274,
20018,
5217,
38832,
32036,
37523,
12526,
14091,
15794,
16394,
19337,
17928,
30866,
30109,
31800,
32434,
6803,
11249,
11250,
11440,
8720,
8975,
37376,
36589,
41669,
5111,
4646,
35675,
953,
993,
304,
28410,
5873,
8903,
20019,
22046,
20447,
18821,
4559,
29107,
4222,
37524,
1493,
476,
3721,
37454,
38914,
35473,
27996,
18355,
32505,
8802,
9397,
28488,
5727,
42091,
6782,
31078,
32947,
31496,
32037,
9146,
8144,
8165,
12028,
11811,
18595,
17929,
17930,
20395,
20020,
20713,
22047,
21856,
16632,
16262,
17182,
15752,
14796,
14868,
12603,
12912,
42092,
42093,
39996,
40216,
37005,
6278,
4871,
5068,
4971,
35087,
34929,
6663,
33978,
28061,
286,
440,
1053,
3700,
3895,
3400,
2681,
1843,
25816,
23243,
41426,
41601,
42435,
40701,
23565,
24950,
26087,
27161,
27124,
27037,
26699,
27416,
27748,
3699,
2810,
1367,
1386,
33979,
34524,
34887,
35971,
4809,
4312,
37047,
38083,
37910,
37796,
41924,
42356,
38413,
38414,
12954,
12604,
14092,
13751,
14797,
16034,
16634,
16438,
21430,
21431,
21307,
22048,
20021,
17931,
18596,
19338,
19754,
19755,
19689,
19694,
11441,
10869,
10408,
9722,
9448,
9933,
7688,
9398,
31079,
31434,
32690,
6783,
29943,
4456,
150,
28257,
7721,
18501,
18485,
11442,
42176,
30854,
36768,
1079,
2375,
4185,
34185,
12029,
11251,
22049,
17302,
23566,
23567,
2948,
17303,
14798,
15343,
13667,
21441,
8425,
29108,
12887,
13457,
29677,
21432,
21433,
21434,
22465,
20023,
20694,
18356,
18357,
19065,
13193,
13752,
14709,
16035,
16036,
16037,
17304,
16538,
16635,
32039,
29109,
29110,
29557,
32038,
33250,
30110,
30111,
33426,
8359,
9147,
7513,
12030,
9934,
9761,
2760,
3693,
3487,
2303,
1595,
657,
570,
28452,
28413,
28182,
27997,
27985,
27847,
23401,
22735,
24368,
27114,
27162,
26099,
26246,
6732,
34186,
6367,
36769,
36715,
37076,
38008,
41120,
39023,
38952,
42206,
40124,
21303,
725,
22586,
17305,
16038,
29111,
34187,
35101,
17052,
35698,
37137,
24136,
38164,
17405,
6175,
17353,
17932,
21435,
25324,
39456,
18324,
19757,
19339,
7850,
8569,
27172,
475,
20714,
17306,
7753,
25908,
6733,
26807,
11443,
11444,
7075,
17307,
16636,
19340,
17933,
857,
35973,
39675,
35715,
4901,
149,
2467,
2508,
3701,
30112,
36253,
22050,
16039,
13194,
12393,
6201,
34034,
17934,
12605,
15923,
8055,
38711,
15419,
12955,
17935,
2271,
1522,
10756,
14093,
14799,
3162,
3607,
35088,
41232,
1830,
36770,
1656,
15429,
16637,
42591,
18597,
19758,
30113,
32040,
32042,
30920,
30753,
10409,
19341,
21857,
16439,
17308,
13192,
2902,
38122,
42270,
35159,
34188,
34223,
6220,
4683,
4567,
40985,
23412,
19342,
263,
26700,
4589,
22051,
11346,
8448,
32041,
40193,
40241,
36298,
23568,
24177,
29780,
18598,
18599,
31568,
37093,
24370,
22736,
2986,
2869,
1730,
2239,
36771,
37975,
38879,
12031,
17724,
22052,
13195,
15410,
41234,
6700,
2468,
35974,
33679,
20024,
19242,
28552,
37362,
39635,
35975,
34189,
24371,
20585,
16040,
30115,
28835,
31481,
31080,
11782,
13799,
28688,
37930,
26389,
24027,
27854,
36452,
39095,
17477,
10931,
10410,
30294,
32043,
31717,
35089,
24951,
5734,
41646,
30114,
42044,
38172,
13753,
27721,
26808,
24209,
23569,
3313,
34720,
15929,
16440,
16638,
20026,
9392,
10932,
41408,
12032,
11812,
11252,
11253,
11254,
8302,
8760,
32044,
8131,
7164,
31932,
31630,
31696,
29621,
20027,
20028,
20308,
21679,
17579,
17725,
17936,
15739,
13536,
14605,
14274,
42345,
42391,
41194,
38273,
36398,
36348,
36737,
36772,
36673,
36992,
34190,
35497,
5714,
5362,
6385,
4728,
5240,
2242,
28062,
762,
23661,
25133,
26733,
27011,
26247,
25965,
42615,
41233,
151,
3951,
3221,
445,
9036,
6055,
39028,
555,
26050,
26249,
10933,
29175,
33001,
30563,
16441,
18002,
22209,
26119,
3896,
33162,
30094,
10411,
2959,
39982,
22053,
39052,
36993,
38087,
5425,
4699,
4545,
34643,
33814,
1693,
1694,
797,
1334,
1286,
1018,
145,
28063,
27959,
28385,
26251,
25326,
24224,
23931,
23570,
23571,
23424,
22737,
22054,
20029,
20030,
20109,
20705,
20695,
16409,
16547,
16639,
17310,
17311,
17312,
16041,
15712,
14024,
13196,
13338,
10711,
9762,
10934,
11918,
11445,
11447,
11448,
9037,
8877,
8411,
6972,
7330,
30855,
33222,
30017,
16640,
814,
1609,
29604,
3608,
3340,
25327,
20031,
21436,
19343,
40674,
19195,
18600,
22466,
20715,
15430,
14800,
28693,
9945,
26252,
1555,
5136,
5587,
37525,
38785,
40759,
39276,
31358,
37855,
6333,
33434,
14801,
42207,
6411,
12606,
26182,
42025,
2554,
28064,
24049,
22340,
31811,
11429,
25328,
3365,
42392,
38887,
27198,
24374,
30885,
9148,
38694,
34191,
40780,
16042,
16442,
29782,
30514,
17313,
40685,
9399,
13004,
17314,
17437,
26968,
22738,
3075,
6291,
7765,
13754,
19344,
9008,
37235,
3282,
2942,
27163,
27164,
41373,
2670,
28258,
5060,
32969,
22405,
13486,
7391,
4150,
2761,
2762,
3259,
9763,
12394,
14802,
12395,
31646,
31647,
9935,
1844,
34074,
16443,
33044,
33252,
25329,
1125,
33236,
32646,
11449,
39561,
9400,
10935,
11255,
12033,
27042,
4457,
10208,
30728,
14803,
14276,
27799,
11450,
11194,
29785,
19345,
3486,
22739,
22055,
12396,
35474,
14804,
9294,
34192,
4313,
3995,
3445,
25141,
37127,
30116,
41447,
42030,
8145,
14331,
37775,
6202,
22376,
9936,
15170,
27165,
17054,
30931,
9401,
21100,
7823,
27166,
14,
19347,
18974,
16043,
22056,
35563,
26809,
7214,
14277,
12608,
3163,
6429,
35595,
36994,
31858,
34193,
9149,
28211,
40540,
39699,
9038,
29286,
30027,
13679,
33253,
26254,
27937,
4627,
39594,
37020,
28579,
3378,
13755,
16044,
20032,
18358,
39305,
16642,
16643,
30731,
21275,
40807,
32045,
7942,
12397,
14027,
15411,
22467,
9937,
9938,
4420,
17055,
17222,
22740,
34194,
37112,
39702,
29113,
14805,
19904,
3193,
26255,
7002,
39796,
1652,
40535,
31865,
30117,
30107,
36773,
20033,
20696,
14806,
34879,
3312,
3897,
23532,
39873,
39306,
3848,
2916,
2026,
110,
147,
35091,
35976,
34195,
34545,
15796,
14278,
19695,
18603,
17588,
9403,
12035,
23572,
23573,
19724,
17316,
13537,
2469,
37968,
33042,
8182,
25909,
25330,
26810,
27752,
23574,
22741,
24375,
24348,
2639,
1735,
2720,
27998,
28143,
28127,
28212,
1312,
37911,
37905,
38287,
37526,
40539,
41132,
42285,
39591,
40242,
39596,
39024,
33834,
33797,
4314,
4315,
4949,
6386,
6138,
8616,
9039,
8784,
8782,
6970,
7790,
11219,
10936,
10757,
31081,
30862,
32046,
33028,
6934,
13538,
14279,
12609,
12610,
12893,
13197,
16644,
16645,
16646,
16555,
15421,
19348,
19066,
20706,
21173,
20034,
20035,
22008,
21437,
21438,
39499,
39976,
33521,
10758,
31826,
13198,
14280,
33254,
32047,
22017,
4468,
40025,
30193,
31409,
31547,
10835,
11451,
8904,
4316,
5544,
404,
2052,
27753,
13756,
13539,
19349,
25331,
23575,
5826,
6056,
6254,
4911,
37136,
28463,
14281,
14528,
8135,
31648,
33643,
7003,
7397,
9404,
11452,
11453,
9940,
31082,
32345,
15137,
17317,
18359,
21439,
20036,
349,
23367,
24234,
27168,
37980,
5028,
6464,
33835,
35977,
41235,
33255,
30118,
15412,
19900,
31083,
10412,
9405,
9040,
8083,
8020,
39271,
24097,
636,
7400,
3996,
1584,
37697,
32738,
18604,
20716,
20697,
12036,
11813,
37323,
11256,
31718,
35786,
34889,
11257,
16647,
13098,
37740,
35211,
35492,
20037,
10759,
29786,
32169,
34196,
5279,
4990,
2682,
23244,
22742,
14282,
15171,
22059,
23576,
1984,
38788,
40877,
37234,
4142,
6427,
6093,
5944,
6527,
35430,
1797,
1790,
2602,
2603,
2387,
2409,
3481,
3127,
877,
878,
879,
28065,
23577,
22743,
27170,
26619,
27348,
21440,
20448,
17728,
19350,
19067,
17056,
13199,
13200,
13201,
13386,
31538,
10760,
10754,
10413,
10414,
9941,
7396,
7216,
8007,
7954,
8711,
8216,
29013,
7838,
11454,
26256,
146,
35576,
27855,
40735,
34330,
13757,
14807,
19068,
19759,
18606,
30754,
387,
40941,
41236,
20698,
2944,
42607,
911,
8905,
40208,
32048,
14283,
23579,
37200,
10937,
12037,
9942,
7505,
31517,
30119,
17216,
18607,
34197,
25332,
3130,
32049,
31109,
7445,
4263,
35978,
30165,
16648,
28939,
6019,
26257,
3547,
264,
18305,
17846,
17318,
33635,
6892,
9872,
223,
23580,
4445,
34541,
36569,
19069,
29517,
8072,
14808,
26811,
25333,
22744,
24187,
18932,
18608,
7620,
30120,
9150,
29100,
20708,
22745,
32691,
18609,
19351,
24377,
16649,
14284,
20718,
8657,
23581,
5799,
9406,
22414,
19070,
41974,
4382,
8544,
11455,
33257,
36774,
42267,
24831,
25837,
3446,
15797,
16384,
30577,
6394,
26962,
24379,
24098,
6094,
35744,
39577,
40243,
10209,
22369,
42569,
42504,
19352,
9108,
23582,
2145,
2683,
2684,
35979,
12039,
16444,
24372,
26969,
1648,
33054,
42043,
19369,
38782,
27171,
27405,
2749,
4487,
34086,
39578,
14285,
14286,
33107,
13576,
27123,
35092,
19712,
31545,
11910,
28411,
37486,
12040,
17106,
29114,
5874,
35596,
37966,
41151,
29115,
14287,
20038,
39184,
15172,
34198,
40689,
3797,
35093,
35094,
37201,
3548,
25334,
14809,
14810,
12611,
17726,
32050,
33258,
12041,
39282,
41686,
40987,
21174,
13540,
19071,
12706,
7096,
958,
34016,
21123,
20039,
23134,
1675,
18611,
15432,
22061,
31719,
3341,
34890,
5451,
37895,
4628,
29950,
12957,
38739,
11258,
7629,
20699,
42177,
26259,
28259,
25184,
26258,
27826,
1556,
42393,
33259,
39889,
42622,
30121,
11457,
11458,
21805,
40244,
6095,
6734,
3620,
29116,
31485,
12958,
15413,
39522,
35841,
312,
7658,
9407,
17057,
17088,
16650,
12306,
3952,
26766,
9943,
17058,
20709,
34670,
24099,
13202,
33260,
32051,
36417,
6866,
31360,
19760,
21478,
16046,
31435,
28694,
8855,
7446,
38054,
9311,
13203,
3560,
27967,
39971,
1394,
1153,
1222,
38614,
16651,
7993,
28794,
29117,
28940,
40039,
37793,
1611,
12042,
24609,
12043,
38308,
10170,
25854,
32052,
26755,
33098,
41389,
3953,
765,
27970,
37527,
16047,
5470,
6307,
40183,
4851,
14811,
39716,
37217,
28620,
3515,
5941,
34933,
14741,
17727,
11259,
38809,
24100,
23583,
2233,
753,
3459,
23158,
24380,
37154,
10210,
30525,
31084,
37949,
36421,
6564,
6465,
3401,
2408,
2470,
29587,
19354,
21335,
33261,
9105,
24381,
23584,
25335,
36777,
40411,
24382,
2992,
28422,
41008,
40421,
28591,
15,
901,
485,
3117,
1834,
23117,
40392,
37189,
6203,
4902,
4629,
4464,
4144,
35458,
10190,
10416,
12044,
33669,
31720,
29492,
33262,
29789,
30122,
19355,
19209,
18612,
21858,
1889,
6585,
992,
24953,
25264,
18613,
38911,
4105,
40932,
1530,
10417,
41237,
11459,
10938,
7732,
30123,
6818,
17320,
19812,
21175,
16652,
357,
3283,
2905,
6157,
34945,
34996,
34722,
5819,
4317,
39030,
37162,
37386,
3825,
2087,
1743,
469,
26812,
24383,
23586,
23864,
15095,
13615,
21442,
22468,
22469,
19761,
31436,
32579,
32983,
30527,
9094,
9151,
9408,
40732,
34896,
39953,
12612,
24955,
13758,
20041,
39929,
7144,
2162,
6096,
10939,
39174,
30522,
4810,
36778,
9764,
40356,
21136,
9944,
27774,
19356,
26065,
17321,
33263,
24275,
23245,
11347,
9152,
9409,
42314,
30980,
31085,
39628,
17059,
12895,
38625,
35468,
30718,
37326,
37974,
34884,
34200,
6878,
29691,
24888,
5083,
1718,
41468,
38533,
26262,
26263,
27999,
32054,
9097,
8773,
7660,
29014,
40173,
32055,
4755,
20719,
38927,
5603,
2334,
2685,
2686,
2960,
25337,
22470,
13204,
29118,
32056,
33264,
7300,
9410,
8390,
11260,
4685,
6664,
30170,
31086,
34093,
38801,
27173,
24850,
23587,
40197,
40400,
35095,
30601,
32692,
29791,
32057,
9411,
16653,
14812,
21443,
20700,
17941,
19762,
19073,
7599,
30541,
28423,
27882,
36780,
40048,
35597,
15423,
8087,
7004,
11783,
19763,
41387,
3770,
3488,
26100,
22063,
17322,
15322,
35418,
33702,
33265,
31087,
30755,
32580,
28907,
11460,
10690,
8017,
8632,
16654,
16049,
13205,
14016,
17323,
17942,
18761,
21444,
20720,
20710,
21101,
34542,
4363,
41052,
38056,
37238,
25339,
27001,
23121,
24735,
24384,
2799,
3234,
3235,
3348,
3067,
688,
829,
41433,
12334,
12045,
8089,
6991,
30724,
41152,
28692,
3549,
42553,
28582,
40663,
40672,
28213,
30125,
8763,
17664,
3798,
17060,
20449,
30126,
28920,
29120,
28787,
31510,
20701,
28000,
38517,
36418,
6528,
8324,
11461,
41238,
38028,
2651,
27174,
10940,
17943,
38499,
4302,
4511,
35914,
38263,
38141,
42094,
2822,
18614,
18615,
16050,
14606,
9765,
14289,
5493,
2471,
10712,
19357,
11462,
28492,
39495,
25340,
22633,
39444,
41984,
19764,
4405,
40364,
23588,
17944,
23589,
23246,
22746,
25822,
5950,
6701,
34684,
34503,
20741,
13206,
31346,
32739,
32520,
32949,
7301,
16655,
2917,
17324,
16,
13760,
33940,
34202,
4266,
4189,
38747,
38212,
37807,
1532,
1294,
2893,
1696,
26646,
24007,
17555,
17729,
32058,
12398,
908,
18616,
29946,
20450,
15798,
24827,
27175,
37749,
41239,
27176,
24385,
22747,
22748,
274,
2182,
37528,
38012,
36444,
38514,
39620,
4223,
4270,
6466,
35097,
34902,
15433,
15173,
15114,
16656,
16099,
13761,
13762,
21176,
22471,
17945,
29955,
29121,
29122,
28926,
31088,
30127,
11463,
11789,
11356,
39307,
41024,
2318,
27775,
1926,
3231,
36423,
4063,
38953,
36605,
9946,
9947,
8990,
29593,
14290,
12613,
16052,
16054,
16568,
17061,
17062,
17063,
17149,
17204,
15174,
14813,
14814,
14815,
14936,
15347,
15608,
15780,
15958,
15952,
12491,
12492,
12310,
12311,
13207,
12880,
14291,
14292,
14203,
14187,
14570,
13763,
13764,
13765,
14094,
17946,
17947,
17325,
17326,
17328,
18618,
19905,
19358,
19487,
19074,
19228,
22472,
21445,
21446,
21859,
21815,
21177,
20721,
20451,
20043,
20044,
20045,
20046,
20047,
20048,
29602,
29537,
29518,
29124,
29954,
32161,
29792,
29880,
6805,
31722,
32061,
32062,
28852,
28864,
33712,
30982,
30455,
30128,
30129,
32059,
30512,
33266,
30665,
9412,
9413,
9414,
9415,
9028,
9153,
7272,
7072,
7005,
7379,
8175,
7929,
7930,
7650,
7881,
9766,
10418,
10211,
11362,
11262,
11263,
11768,
12046,
12047,
12048,
12049,
11464,
36624,
36781,
37139,
37122,
37113,
37098,
37049,
38018,
38064,
38088,
38119,
38288,
38762,
38388,
37529,
38138,
38193,
37750,
37856,
37681,
38954,
38868,
38811,
42095,
42045,
42459,
39999,
41632,
41153,
41133,
40245,
40246,
42343,
4318,
4171,
6396,
5316,
5812,
34958,
35100,
35102,
35103,
35104,
34723,
35205,
35099,
35980,
35981,
34203,
34204,
34205,
34206,
34207,
34208,
34725,
34724,
34815,
34662,
34588,
6736,
6665,
2855,
2671,
3826,
3997,
3621,
3685,
1707,
1703,
1787,
288,
111,
28638,
28364,
28001,
28128,
852,
799,
770,
743,
615,
467,
468,
545,
1379,
1374,
1484,
1152,
25817,
25341,
25342,
25343,
25344,
25910,
26265,
22749,
22750,
22751,
23452,
23590,
24386,
24387,
24245,
24013,
23994,
23988,
24054,
24101,
40676,
39938,
39308,
40596,
41905,
42579,
41561,
41565,
41580,
37883,
23591,
37815,
4852,
24388,
24442,
20049,
40610,
28412,
29125,
27687,
27179,
23247,
27180,
6176,
35105,
37530,
37387,
42427,
31089,
32063,
10723,
12960,
14545,
15940,
30358,
19180,
10941,
7374,
9416,
30897,
30130,
33267,
28877,
36516,
34726,
27746,
25345,
40447,
39879,
33268,
42348,
31649,
24102,
37307,
9725,
3561,
6364,
30567,
37064,
13178,
5084,
29127,
24389,
9156,
2626,
1313,
33713,
36599,
38840,
30131,
12353,
20452,
20702,
8266,
10419,
33045,
13208,
41131,
41154,
4296,
34209,
6737,
6738,
24390,
24847,
26267,
42542,
17948,
22845,
23592,
2987,
28002,
39708,
19218,
14293,
14095,
7763,
16056,
38226,
2049,
9154,
32950,
15799,
22473,
1859,
35425,
28644,
22754,
24889,
13766,
41551,
19359,
12615,
29644,
27181,
7042,
17329,
406,
2640,
35106,
4700,
21102,
27182,
21447,
10212,
32708,
16658,
12616,
20712,
25346,
33972,
28853,
36500,
2509,
2071,
7392,
14044,
21369,
17949,
35505,
4889,
36784,
37682,
35537,
18325,
17330,
10420,
10605,
29649,
30756,
7204,
34099,
37531,
32693,
5047,
24956,
41374,
21387,
21448,
41147,
5875,
14816,
15317,
26815,
9155,
22756,
31090,
267,
35822,
32064,
18619,
13534,
40795,
25911,
41504,
4446,
4620,
4319,
42643,
21860,
6057,
8063,
12073,
5563,
37248,
30449,
29126,
31509,
11465,
38131,
38133,
41525,
24269,
22373,
28260,
23187,
15800,
7948,
10761,
26679,
1772,
18620,
39494,
40842,
18621,
15753,
37292,
31650,
899,
5971,
16057,
4953,
28613,
38742,
34632,
41873,
2652,
13994,
35005,
24226,
23453,
33941,
17950,
7302,
18360,
22064,
8241,
22758,
5142,
11466,
7107,
14565,
30001,
40855,
19765,
14817,
9041,
4470,
25347,
31651,
2555,
38674,
39687,
41240,
1659,
486,
1476,
34210,
41533,
24748,
31091,
10942,
39627,
41098,
42596,
42096,
18361,
40792,
18622,
12711,
12618,
35983,
37428,
40247,
26142,
26066,
14608,
17331,
42208,
39580,
42394,
39674,
37721,
35107,
35499,
4811,
6204,
25348,
21178,
12818,
14818,
9948,
31555,
31092,
41241,
10943,
22065,
19075,
23593,
148,
1798,
16357,
16659,
12399,
13768,
21861,
20722,
11467,
9601,
8739,
7556,
29795,
29748,
1359,
23594,
23248,
22759,
6207,
34547,
35984,
35598,
10811,
6018,
35793,
37835,
14819,
21979,
15176,
10944,
12050,
40817,
6603,
39309,
29796,
36461,
38716,
5779,
11468,
7460,
32068,
29967,
18623,
14820,
14821,
7138]
    
    # Initialize progress counter
    from multiprocessing import Value
    progress_counter = Value('i', 0)
    progress_counter.total = len(bpr_numbers)
    
    print(f"Starting scraping of {len(bpr_numbers)} attorneys...")
    print(f"Configuration: {MAX_WORKERS} workers, {MIN_DELAY}-{MAX_DELAY}s delay between requests")
    print(f"Error delay: {ERROR_DELAY_MIN}-{ERROR_DELAY_MAX}s after failed requests")
    print(f"Max retries: {MAX_RETRIES}")
    
    all_attorney_data = []
    failed_requests = []
    start_time = time.time()
    
    # First pass - initial scraping
    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as executor:
        process_func = partial(process_bpr_number, progress_counter=progress_counter)
        futures = {executor.submit(process_func, num): num for num in bpr_numbers}
        
        for future in as_completed(futures):
            try:
                result = future.result()
                if result:
                    if 'Error' in result:
                        failed_requests.append(result['BPR_Number'])
                    all_attorney_data.append(result)
            except Exception as e:
                bpr_num = futures[future]
                print(f"\nError processing BPR {bpr_num:06d}: {e}", file=sys.stderr)
                failed_requests.append(str(bpr_num))
                time.sleep(random.uniform(ERROR_DELAY_MIN, ERROR_DELAY_MAX))
    
    # Second pass - retry failed requests
    if failed_requests:
        print(f"\n\nRetrying {len(failed_requests)} failed requests...")
        retry_counter = Value('i', 0)
        retry_counter.total = len(failed_requests)
        
        with ThreadPoolExecutor(max_workers=MAX_WORKERS) as executor:
            process_func = partial(process_bpr_number, progress_counter=retry_counter)
            futures = {executor.submit(process_func, int(num)): num for num in failed_requests}
            
            for future in as_completed(futures):
                try:
                    result = future.result()
                    if result:
                        # Replace the failed entry in the results
                        for i, item in enumerate(all_attorney_data):
                            if item['BPR_Number'] == result['BPR_Number']:
                                all_attorney_data[i] = result
                                break
                except Exception as e:
                    num = futures[future]
                    print(f"\nError retrying BPR {num:06d}: {e}", file=sys.stderr)
                    time.sleep(random.uniform(ERROR_DELAY_MIN, ERROR_DELAY_MAX))
    
    # Calculate statistics
    success_count = len([a for a in all_attorney_data if 'Error' not in a])
    error_count = len(bpr_numbers) - success_count
    elapsed_time = time.time() - start_time
    
    # Save the collected data to a JSON file
    timestamp = time.strftime("%Y%m%d_%H%M%S")
    output_file = f'attorney_data_{timestamp}.json'
    
    with open(output_file, 'w') as f:
        json.dump(all_attorney_data, f, indent=2)
    
    print("\n\nScraping complete!")
    print(f"Results saved to {output_file}")
    print(f"Successfully scraped: {success_count}")
    print(f"Failed: {error_count}")
    print(f"Total time: {elapsed_time:.2f} seconds")
    print(f"Average time per request: {elapsed_time/len(bpr_numbers):.2f} seconds")

if __name__ == "__main__":
    main()